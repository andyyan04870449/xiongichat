# 雄i聊系統測試腳本總覽

## 📋 測試腳本分類統計

**總計**: 1410+ 個測試檔案

### 主要測試類別

1. **對話流程測試** (8個) - 測試完整對話互動流程
2. **RAG檢索測試** (多個) - 測試知識庫檢索功能
3. **工作流測試** (多個) - 測試LangGraph工作流程
4. **記憶功能測試** (多個) - 測試對話記憶管理
5. **資料上傳測試** (多個) - 測試檔案上傳功能
6. **危機檢測測試** (多個) - 測試危機干預機制
7. **品質評估測試** (多個) - 測試回應品質
8. **性能壓力測試** (多個) - 測試系統負載能力
9. **架構功能測試** (多個) - 測試系統架構組件

---

## 🗣️ 對話流程測試腳本詳解

### 1. run_long_conversation_test_simple.py
**目的**: 簡化版長對話測試，忽略intent錯誤
**特色**:
- 5個測試場景：個人資訊記憶、情緒追蹤、事件記憶、戒毒進展、關係記憶
- 每個場景3-4輪對話
- 自動檢查最後一輪是否包含關鍵資訊
- 生成JSON報告檔案

**測試場景**:
```
個人資訊記憶: "我叫阿明，今年35歲" → "你記得我幾歲嗎？"
情緒追蹤: "今天心情很差" → "我的心情怎麼樣？"
事件記憶: "週一我去了醫院" → "這週我做了什麼？"
戒毒進展: "我已經戒毒3個月了" → "到女兒生日我戒毒多久了？"
關係記憶: "我太太很支持我" → "誰對我幫助最大？"
```

### 2. test_natural_conversation.py
**目的**: 測試自然對話流程，避免過度提供聯絡資訊
**特色**:
- 5階段情緒變化測試
- 檢查RAG觸發的適當性
- 評估聯絡資訊提供的合理性
- 計算RAG觸發準確率和回應適當性

**測試流程**:
```
初始情緒困擾 → 繼續表達困擾 → 表達需要幫助 → 情緒緩和 → 一般對話
```

### 3. test_emotion_progression.py
**目的**: 測試情緒變化進程的策略升級系統
**特色**:
- 7階段完整情緒變化：打招呼 → 激動 → 持續激動 → 更加激動 → 開始緩和 → 逐漸平靜 → 完全平靜
- 追蹤策略升級記錄
- 評估情緒識別、風險評估、策略選擇準確度
- 詳細的性能統計

**關鍵指標**:
- 情緒識別準確率
- 風險評估準確率  
- 策略選擇準確率
- 平均處理時間

### 4. run_memory_enhanced_conversation_test.py
**目的**: 測試增強記憶系統的長期對話能力
**特色**:
- 50輪對話的極限測試
- 包含記憶注入、檢索、更新測試
- 複雜情境：個人背景建立、情緒變化、進展追蹤、危機處理、成果確認
- 詳細的記憶系統分析

### 5. run_extreme_conversation_test.py  
**目的**: 極限對話測試，評估系統在長時間對話中的穩定性
**特色**:
- 超長對話測試（通常50輪以上）
- 壓力測試系統性能
- 評估記憶一致性
- 檢測系統降級和恢復能力

### 6. run_complete_test_scenarios.py
**目的**: 完整的測試場景套件
**特色**:
- 整合多種測試類型
- 完整的系統功能驗證
- 生成綜合測試報告
- 包含性能基準測試

### 7. run_test_scenarios.py
**目的**: 基礎測試場景執行器
**特色**:
- 標準測試流程
- 基本功能驗證
- 快速回歸測試
- 適合日常開發驗證

### 8. test_simple_scenarios.py
**目的**: 簡化版測試場景
**特色**:
- 快速驗證核心功能
- 簡化的測試邏輯
- 適合快速調試
- 基礎功能驗證

---

## 🎯 測試執行建議

### 日常開發驗證
```bash
python test_simple_scenarios.py          # 快速功能驗證
python test_natural_conversation.py      # 對話流程驗證
```

### 功能完整性測試
```bash
python run_test_scenarios.py             # 標準測試套件
python run_complete_test_scenarios.py    # 完整功能測試
```

### 性能和穩定性測試
```bash
python test_emotion_progression.py       # 情緒處理能力
python run_memory_enhanced_conversation_test.py  # 記憶系統測試
python run_extreme_conversation_test.py  # 極限壓力測試
```

### 記憶功能專項測試
```bash
python run_long_conversation_test_simple.py  # 基礎記憶測試
```

---

## 📊 測試報告檔案

所有測試都會生成帶時間戳的JSON報告檔案：
- `simple_long_conversation_report_YYYYMMDD_HHMMSS.json`
- `emotion_progression_test_TIMESTAMP.json`
- `complete_test_report_YYYYMMDD_HHMMSS.json`
- `memory_enhanced_test_report_YYYYMMDD_HHMMSS.json`

這些報告包含詳細的測試結果、性能指標和錯誤分析。

---

## 🔧 測試配置

### 環境變數
```
USE_ULTIMATE_WORKFLOW=true  # 啟用UltimateWorkflow
LOG_LEVEL=CRITICAL         # 減少錯誤輸出
```

### 共同特徵
- 所有測試都使用UltimateWorkflow
- 支援非同步執行
- 自動生成unique用戶ID和對話ID
- 包含錯誤處理和重試機制
- 生成詳細的測試報告

此文檔作為測試腳本參考，避免重複搜尋測試檔案。